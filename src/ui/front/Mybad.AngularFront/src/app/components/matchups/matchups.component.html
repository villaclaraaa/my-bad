<div class="matchups-container md:mt-0 m-2 rounded ">
  <!-- Matchups Page -->
  
  <!-- Teams Section -->
  <div class="teams-section">
    <!-- My Team -->
    <div class="team-panel">
      <h2>My Team</h2>
      <div class="team-slots">
        <div class="slot" *ngFor="let hero of myTeam()" (click)="removeHero(hero, 'my')">
          <img [src]="getHeroImg(hero.img)" [alt]="hero.localized_name">
          <div class="slot-name">{{ hero.localized_name }}</div>
        </div>
        <div class="pool-hero empty" *ngIf="myTeam().length < 5" (click)="openPicker('my')">
          <span>+</span>
        </div>
      </div>
    </div>

    <div class="swap-button-container">
      <button class="swap-btn" title="Swap teams" (click)="swapTeams()" [disabled]="myTeam().length === 0 && enemyTeam().length === 0">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M8 3L4 7l4 4"/>
          <path d="M4 7h16"/>
          <path d="M16 21l4-4-4-4"/>
          <path d="M20 17H4"/>
        </svg>
      </button>
    </div>
    <!-- Enemy Team -->
    <div class="team-panel">
      <h2>Enemy Team</h2>
      <div class="team-slots">
        <div class="slot" *ngFor="let hero of enemyTeam()" (click)="removeHero(hero, 'enemy')">
          <img [src]="getHeroImg(hero.img)" [alt]="hero.localized_name">
          <div class="slot-name">{{ hero.localized_name }}</div>
        </div>
        <div class="pool-hero empty" *ngIf="enemyTeam().length < 5" (click)="openPicker('enemy')">
          <span>+</span>
        </div>
      </div>
    </div>
  </div>

  <!-- Results Section -->
  <div class="results-section">
    
    <!-- Best Ally -->
    <div class="result-column">
      <h3>Best with allies</h3>

      <div *ngIf="isLoadingAlly()" class="loader-container">
        <app-loadingspinner [isLoading]="isLoadingAlly()"></app-loadingspinner>
        <span>Loading...</span>
      </div>

      <div *ngIf="!isLoadingAlly()" class="result-list">
        <div class="result-item" *ngFor="let m of bestAlly(); let i = index">
          <span class="res-number">{{ i + 1 }})</span>
          <img [src]="getHeroImgById(m.heroId)" class="result-hero-img">
          <span class="res-name">{{ m.heroName | heronamespipe }}</span>
        </div>
      </div>
    </div>

    <!-- Best Computed -->
    <div class="result-column highlight">
      <h3>Best computed</h3>

      <div *ngIf="isLoadingComputed()" class="loader-container">
        <app-loadingspinner [isLoading]="isLoadingComputed()"></app-loadingspinner>
        <span>Loading...</span>
      </div>

      <div *ngIf="!isLoadingComputed()" class="result-list">
        <div class="result-item" *ngFor="let m of bestComputed(); let i = index">
          <span class="res-number">{{ i + 1 }})</span>
          <img [src]="getHeroImgById(m.heroId)" class="result-hero-img">
          <span class="res-name">{{ m.heroName | heronamespipe }}</span>
        </div>
      </div>
    </div>

    <!-- Best Versus -->
    <div class="result-column">

      <h3>Best vs enemies</h3>
      <div *ngIf="isLoadingVersus()" class="loader-container">
        <app-loadingspinner [isLoading]="isLoadingVersus()"></app-loadingspinner>
        <span>Loading...</span>
      </div>

      <div *ngIf="!isLoadingVersus()" class="result-list">
        <div class="result-item" *ngFor="let m of bestVersus(); let i = index">
          <span class="res-number">{{ i + 1 }})</span>
          <img [src]="getHeroImgById(m.heroId)" class="result-hero-img">
          <span class="res-name">{{ m.heroName | heronamespipe }}</span>
        </div>
      </div>
    </div>

  </div>

  <!-- Hero Pool Section -->
  <div class="hero-pool-section">
    <div class="pool-header">
      <h2>My Hero Pool</h2>
      
      <div class="pool-dropdown-container">
        <button class="pool-dropdown-btn" (click)="togglePoolDropdown()">
          {{ currentPoolName() || 'Add Hero Pool' }}
          <span class="dropdown-arrow">▼</span>
        </button>
        
        <div class="pool-dropdown-menu" *ngIf="isPoolDropdownOpen()">
          <div class="pool-dropdown-item" 
               *ngFor="let pool of getPoolNames()">
            <span (click)="selectPool(pool)">{{ pool }}</span>
            <button class="delete-pool-btn" (click)="deletePool(pool, $event)" title="Delete pool">×</button>
          </div>
          <div class="pool-dropdown-divider" *ngIf="getPoolNames().length > 0"></div>
          <div class="pool-dropdown-item add-new" (click)="openAddPoolDialog()">
            + Add New Pool
          </div>
        </div>
      </div>
      
      <label class="toggle-slider">
        <input type="checkbox" [checked]="isPoolEnabled()" (change)="changeUsingHeroPool()">
        <span class="slider"></span>
        <span class="slider-label">{{ isPoolEnabled() ? 'Enabled' : 'Disabled' }}</span>
      </label>
    </div>
    <p class="pool-description">Select heroes you play to filter recommendations</p>
    
    <div class="pool-container">
      <div class="team-slots">
        <div class="slot" *ngFor="let hero of heroPool()" (click)="removeHeroFromPool(hero)">
          <img [src]="getHeroImg(hero.img)" [alt]="hero.localized_name">
          <div class="slot-name">{{ hero.localized_name }}</div>
        </div>
        <div class="pool-hero empty" (click)="openPicker('pool')">
          <span>+</span>
        </div>
      </div>
    </div>
  </div>

</div>

<!-- Hero Picker Modal -->
<div class="picker-overlay" *ngIf="isPicking()">
  <div class="picker-modal">
    <button class="close-btn" (click)="closePicker()">X</button>
    
    <div class="picker-header">
      <span class="title">Choose hero</span>
      <div class="search-box">
        <input 
          type="text" 
          placeholder="Search..." 
          [ngModel]="searchText()" 
          (ngModelChange)="searchText.set($event)"
        >
      </div>
    </div>

    <div class="attributes-grid">
      
      <div class="attr-column str-col">
        <div class="attr-header">
          <img src="https://cdn.cloudflare.steamstatic.com/apps/dota2/images/dota_react/icons/hero_strength.png" alt="STR">
          <span>Strength</span>
        </div>
        <div class="hero-list">
          <div *ngFor="let hero of filteredGroupedHeroes().str" class="hero-card" (click)="selectHero(hero)">
            <div class="img-wrapper">
               <img [src]="getHeroImg(hero.img)" [alt]="hero.localized_name" loading="lazy">
            </div>
            <div class="hero-name">{{ hero.localized_name }}</div>
          </div>
        </div>
      </div>

      <div class="attr-column agi-col">
        <div class="attr-header">
          <img src="https://cdn.cloudflare.steamstatic.com/apps/dota2/images/dota_react/icons/hero_agility.png" alt="AGI">
          <span>Agility</span>
        </div>
        <div class="hero-list">
          <div *ngFor="let hero of filteredGroupedHeroes().agi" class="hero-card" (click)="selectHero(hero)">
            <div class="img-wrapper">
               <img [src]="getHeroImg(hero.img)" [alt]="hero.localized_name" loading="lazy">
            </div>
            <div class="hero-name">{{ hero.localized_name }}</div>
          </div>
        </div>
      </div>

      <div class="attr-column int-col">
        <div class="attr-header">
           <img src="https://cdn.cloudflare.steamstatic.com/apps/dota2/images/dota_react/icons/hero_intelligence.png" alt="INT">
          <span>Intelligence</span>
        </div>
        <div class="hero-list">
          <div *ngFor="let hero of filteredGroupedHeroes().int" class="hero-card" (click)="selectHero(hero)">
            <div class="img-wrapper">
               <img [src]="getHeroImg(hero.img)" [alt]="hero.localized_name" loading="lazy">
            </div>
            <div class="hero-name">{{ hero.localized_name }}</div>
          </div>
        </div>
      </div>
      
      <div class="attr-column uni-col">
        <div class="attr-header">
           <img src="https://cdn.cloudflare.steamstatic.com/apps/dota2/images/dota_react/icons/hero_universal.png" alt="UNI">
          <span>Universal</span>
        </div>
        <div class="hero-list">
          <div *ngFor="let hero of filteredGroupedHeroes().uni" class="hero-card" (click)="selectHero(hero)">
            <div class="img-wrapper">
               <img [src]="getHeroImg(hero.img)" [alt]="hero.localized_name" loading="lazy">
            </div>
            <div class="hero-name">{{ hero.localized_name }}</div>
          </div>
        </div>
      </div>

    </div>
  </div>
</div>

<!-- Add New Pool Dialog -->
<div class="picker-overlay" *ngIf="isAddingNewPool()">
  <div class="add-pool-dialog">
    <h3>Create New Hero Pool</h3>
    <input 
      type="text" 
      class="pool-name-input" 
      placeholder="Enter pool name..."
      [(ngModel)]="newPoolName"
      (keyup.enter)="confirmAddPool()"
    >
    <div class="dialog-buttons">
      <button class="dialog-btn cancel" (click)="cancelAddPool()">Cancel</button>
      <button class="dialog-btn confirm" (click)="confirmAddPool()" [disabled]="!newPoolName.trim()">Create</button>
    </div>
  </div>
</div>
