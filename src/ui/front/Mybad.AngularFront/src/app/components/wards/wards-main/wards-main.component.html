<div class="flex flex-col md:flex-row w-full gap-4">

  <!-- LEFT: 1/3 on desktop, full on mobile -->
  <div class="md:w-2/5 flex flex-col gap-4" [ngClass]="activeTab() == 'none' ? 'mx-auto' : ''">
    <!-- Search box -->
    <div class="flex items-center gap-3 bg-slate-600 mx-1 md:mx-4 p-1 mt-4 md:mt-2 rounded-lg shadow-lg">

      <!-- Flexible input -->
      <input type="text" [(ngModel)]="searchQuery" placeholder="Search account…" class=" min-w-0 px-3 py-1 bg-slate-700 text-gray-200 placeholder-gray-400
           rounded-md border border-slate-600
           focus:outline-none focus:ring-2 focus:ring-blue-400" />

      <!-- Fixed or flexible button -->
      <button (click)="searchAccount()" class="px-4 md:px-6 py-1 bg-blue-500 text-white rounded-md
           hover:bg-blue-600 active:scale-95 transition-all cursor-pointer flex-shrink-0">
        ➜
      </button>

      <!-- Account + Avatar -->
      <div class="flex items-center gap-2 text-white px-1 flex-shrink-0">
        <div *ngIf="avatarUrl">
          <img src="{{avatarUrl}}" alt="Player avatar" class="h-6 w-6 rounded-full object-cover" />
        </div>
        <div class="whitespace-nowrap" *ngIf="accountName()">
          <a href={{accountLinkODota}} title="Open profile in OpenDota." target="_blank" class="flex items-center">
            <span class="font-semibold inline-block">{{ accountName() || '' }}</span>
            <svg viewBox="0 0 24 24" fill="#ffffff" xmlns="http://www.w3.org/2000/svg" class="size-5" stroke="#ffffff">
              <g id="SVGRepo_iconCarrier">
                <path d="M16.3891 8.11096L8.61091 15.8891" stroke="#ffffff" stroke-width="2" stroke-linecap="round"
                  stroke-linejoin="round"></path>
                <path d="M16.3891 8.11096L16.7426 12" stroke="#ffffff" stroke-width="2" stroke-linecap="round"
                  stroke-linejoin="round"></path>
                <path d="M16.3891 8.11096L12.5 7.75741" stroke="#ffffff" stroke-width="2" stroke-linecap="round"
                  stroke-linejoin="round"></path>
              </g>
            </svg>
          </a>
        </div>
      </div>
    </div>
  </div>

  <!-- Right - Tabs section -->
  <div class="w-full md:w-3/5 flex flex-col gap-4" *ngIf="!(activeTab() == 'none')">
    <div class="flex justify-center border-b border-slate-600 pt-2 md:hidden">
      <!-- Mobile tabs -->
      <button *ngFor="let t of tabs()" (click)="selectTab(t.key)"
        class="mx-2 px-4 py-2 whitespace-nowrap rounded-t-lg transition-all duration-200 min-h-10 min-w-20"
        [class.bg-slate-600]="activeTab() === t.key" [class.text-white]="activeTab() === t.key"
        [class.text-slate-400]="activeTab() !== t.key" [class.font-semibold]="activeTab() === t.key"
        [class.text-lg]="activeTab() === t.key">
        {{ t.label }}
      </button>
    </div>

    <div class="hidden md:flex border-b border-slate-600 pt-2">
      <!-- Desktop tabs -->
      <button *ngFor="let t of tabs()" (click)="selectTab(t.key)"
        class="mx-2 px-4 whitespace-nowrap rounded-t-lg transition-all duration-200 min-h-10 min-w-20"
        [class.bg-slate-600]="activeTab() === t.key" [class.text-white]="activeTab() === t.key"
        [class.text-slate-400]="activeTab() !== t.key" [class.font-semibold]="activeTab() === t.key"
        [class.text-lg]="activeTab() === t.key">
        {{ t.label }}
      </button>
    </div>
  </div>
</div>

<!-- Content section based on SWITCH -->
<div class="relative flex-1">
  <ng-container [ngSwitch]="activeTab()">
    <div *ngSwitchCase="'map'" class="w-full">
      <app-wardmap [accountId]="accountId()!" (isLoading)="isLoading.set($event)"></app-wardmap>
    </div>
    <div *ngSwitchCase="'efficiency'">
      <app-efficiencymap [accountId]="accountId()!" (isLoadingOutput)="isLoading.set($event)"></app-efficiencymap>
    </div>
    <div *ngSwitchCase="'none'">
      <p class="text-center p-10 m-10">Enter steam account id to perform scanning.</p>
    </div>
  </ng-container>

  <app-error [errorMessages]="apiErrors()"></app-error>
</div>

<app-loadingspinner [isLoading]="isLoading()" [cssClasses]="['absolute', 'inset-0', 'z-40', ' bg-black/50']"></app-loadingspinner>